<lift:surround with="menu/menu-administration" at="content">

<head>
<title>Rudder - Management</title>

<style type="text/css">
  .deca input {
    width: 180px;
  }
  .deca input {
    width: 180px;
  }
  
  .deca input.deleteNetwork {
    width: 20px;
  }
  
  button.defaultButton {
    margin-top: -1px;
    margin-left: 15px;
    padding: 2px;
    width: 100px;
  }
  
  .defaultButton span.ui-button-text {
    padding: 0;
}
  
</style>

</head>
<div class="portlet">
  <div class="portlet-header">Policy server settings</div>
  <div class="portlet-content">

    <div class="intro">
      <div>
        <p>Configure policy server(s).</p>
      </div>
    </div>
    <div class="inner-portlet">
      <div class="inner-portlet-header">Client-server communication</div>
      <div class="portlet-content">

        <div class="intro">
          <div>
            <p>Configure the networks from which nodes are allowed
              to connect to the Rudder policy servers to get their updated
              configuration policy.</p>
            <p>
              You can add as many networks as you want, the expected
              format is: <b>NetworkIP/mask</b>, for example
              "42.42.0.0/16".
            </p>
          </div>
        </div>

        <hr class="spacer" />

        <div>
          <div
            class="lift:administration.EditPolicyServerAllowedNetwork.render">
            <div id="allowedNetworksForm"  class="deca">
              <div id="policyServerDetails"/>
              <div id="policyServerText"/>
	          <form class="lift:form.ajax">
	            <table>
	              <thead>
	                <tr>
	                  <th width="20px">Delete</th>
	                  <th width="200px">Allowed network</th>
	                  <th></th>
	                </tr>
	              </thead>
	              <tbody id="allowNetworkFields">
	                <tr>
	                  <td class="delete"><input
	                    class="deleteNetwork" type="submit"
	                    value="delete" /></td>
	                  <td><input name="network"
	                    class="networkField" /></td>
	                  <td><lift:Msg errorClass="error">[error]</lift:Msg></td>
	                </tr>
	              </tbody>
	            </table>
	            <input id="addNetworkButton" type="submit" value="Add a network" />
	            <input id="submitAllowedNetwork" type="submit" value="Submit" />
	          </form>
            </div>
            <hr class="spacer" />
          </div>
        </div>

        <hr class="spacer" />
        <div class="deca">
          <h3>Security</h3>
          <div class="lift:administration.PropertiesManagement.denyBadClocks" id="denyBadClocksForm">
            <form class="lift:form.ajax">
              <div class="wbBaseField"> 
                    <label class="threeCol wbBaseFieldLabel textright" style="font-weight:bold;width: 50%;">
                      <span style="float:left">Require time synchronization between nodes and policy server: </span>
                      <span id="denyBadClocksTooltip" />
                    </label>
                    <input id="denyBadClocks" type="text"/>
              </div>
              <hr class="spacer"/>
              <div class="wbBaseField"> 
                    <label class="threeCol wbBaseFieldLabel textright" style="font-weight:bold;width: 50%;">
                      <span style="float:left">Use reverse DNS lookups on nodes to reinforce authentication to policy server: </span>
                      <span id="skipIdentifyTooltip" />
                    </label>
                    <input id="skipIdentify" type="text"/>
              </div>
              <hr class="spacer"/>
              <input type="submit" value="[save]" id="cfserverNetworkSubmit"/>
              <lift:Msg id="updateCfserverNetwork">[messages]</lift:Msg>
            </form>
          </div>
        </div>
        <hr class="spacer" />
        
        
      </div>
    </div>
    
    <div class="inner-portlet">
      <div class="inner-portlet-header">Configure change messages</div>
      <div class="portlet-content">


        <div class="intro">
          <div>
            <p>If enabled, prompt users to enter a message explaining the reason for each configuration change they make.</p>
          </div>
        </div>

        <hr class="spacer" />
        <div class="deca">
          <div
            class="lift:administration.PropertiesManagement.changeMessage"
            id="changeMessageForm">
            <form class="lift:form.ajax">
            
              <div class="wbBaseField"> 
                <label class="threeCol wbBaseFieldLabel textright" style="font-weight:bold;width: 20%;">Enable change messages:</label><input id="enabled" type="checkbox"/>
              </div>
              <hr class="spacer"/>
              <div class="wbBaseField">       
                    <label class="threeCol wbBaseFieldLabel textright" style="font-weight:bold;width: 20%;"><span style="float:left">Make message mandatory: </span><span id="mandatoryTooltip" /></label><input id="mandatory" type="checkbox"/>
              </div>
              <hr class="spacer"/>
  		      <div class="wbBaseField"> 
                    <label class="threeCol wbBaseFieldLabel textright" style="font-weight:bold;width: 20%;"><span style="float:left">Explanation to display: </span><span id="explanationTooltip" /></label><input id="explanation" type="text"/><input id="restoreExplanation" type="button"/>
              </div>
              <hr class="spacer"/>
              <input type="submit" value="Reload" id="changeMessageSubmit"/>
              <lift:Msg id="updateChangeMsg">[messages]</lift:Msg>
            </form>
          </div>
        </div>
      </div>
    </div>
    
    
    <div class="inner-portlet">
      <div class="inner-portlet-header">Configure Change Requests (validation workflow)</div>
      <div class="portlet-content">


        <div class="intro">
          <div>
            <p>If enabled, all changes to configuration (Directives, Rules, Groups and Parameters) will be submitted for validation via a Change Request. <br/>
A new Change Request will enter the "<b>Pending validation</b>" status, then can be moved to "<b>Pending deployment</b>" (approved but not yet deployed) or "<b>Deployed</b>" (approved and deployed) statuses.<br/>
Only users with the "<b>validator</b>" or "<b>deployer</b>" roles are authorized to perform these steps (see <i>/opt/rudder/etc/rudder-users.xml</i>).<br/>
<br/>
If disabled, all changes to configuration will be immediately deployed.</p>
          </div>
        </div>

        <hr class="spacer" />
        <div class="deca">
          <div
            class="lift:administration.PropertiesManagement.workflow"
            id="workflowForm">
            <form class="lift:form.ajax">
            
              <div class="wbBaseField"> 
                <label class="threeCol wbBaseFieldLabel textright" style="font-weight:bold;width: 20%;">Enable Change Requests:</label><input id="workflowEnabled" type="checkbox"/>
              </div>
              <hr class="spacer"/>
              <div class="wbBaseField">       
                    <label class="threeCol wbBaseFieldLabel textright" style="font-weight:bold;width: 20%;"><span style="float:left">Allow self validation: </span><span id="selfValTooltip"/></label><input id="selfVal" type="checkbox"/>
              </div>
              <hr class="spacer"/>
  		      <div class="wbBaseField"> 
                    <label class="threeCol wbBaseFieldLabel textright" style="font-weight:bold;width: 20%;"><span style="float:left">Allow self deployment: </span><span id="selfDepTooltip"/></label><input id="selfDep" type="checkbox"/>
              </div>
              <hr class="spacer"/>
              <input type="submit" value="Reload" id="workflowSubmit"/>
              <lift:Msg id="updateWorkflow">[messages]</lift:Msg>
            </form>
          </div>
        </div>
      </div>
    </div>
    
    <div class="inner-portlet">
      <div class="inner-portlet-header">Clear deployment caches</div>
      <div class="portlet-content">

        <div class="intro">
          <div>
            <p>Clear cached data. This
              will trigger a full redeployment, and regenerate
              all promise files.</p>
          </div>
        </div>

        <hr class="spacer" />
        <div class="deca">
          <div class="lift:administration.ClearCache.render"
            id="clearCacheForm">
            <form class="lift:form.ajax">
              <input id="clearCacheButton" type="submit"
                value="[Clear cache]" />
              <lift:Msg id="clearCacheNotice">[error]</lift:Msg>
            </form>
          </div>
        </div>
      </div>
    </div>



    <div class="inner-portlet">
      <div class="inner-portlet-header">Manage dynamic groups</div>
      <div class="portlet-content">

        <div class="intro">
          <div>
            <p>Groups in Rudder can be static (fixed list of nodes) or dynamic (the list of nodes is built from a search query).<br/>
To take into account new nodes and changes to their inventory, dynamic groups must be reloaded regularly.<br/>
Currently, Rudder will automatically do this reload every <b id="dynGroupUpdateInterval">5</b> minutes (see <i>/opt/rudder/etc/rudder-web.properties</i>).
</p>
          </div>
        </div>

        <hr class="spacer" />
        <div class="deca">
          <div class="lift:administration.DyngroupReloading.render"
            id="dyngroupReloadingForm">
            <form class="lift:form.ajax">
              <input id="dyngroupReloadingButton" type="submit"
                value="[Reload dyngroups]" />
              <lift:msg id="dyngroupReloadingNotice"
                errorClass="error">[error]</lift:msg>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="inner-portlet">
      <div class="inner-portlet-header">Manage Technique library</div>
      <div class="portlet-content">

        <div class="intro">
          <div>
            <p>Techniques in Rudder are read from the filesystem (in <i>/var/rudder/configuration-repository/techniques</i>).<br/>
To take into account new Techniques and changes, the Technique library must be updated regularly.<br/>
Currently, Rudder will automatically do this update every <b id="techniqueLibraryUpdateInterval">5</b> minutes (see <i>/opt/rudder/etc/rudder-web.properties</i>).
</p>
          </div>
        </div>

        <hr class="spacer" />
        <div class="deca">
          <div
            class="lift:administration.TechniqueLibraryManagement.reloadTechniqueButton"
            id="reloadTechniqueLibForm">
            <form class="lift:form.ajax">
              <input type="submit" value="Reload" />
              <lift:Msg id="updateLib">[messages]</lift:Msg>
            </form>
          </div>
        </div>
      </div>
    </div>
    
    

  </div>
</div>
</lift:surround>

