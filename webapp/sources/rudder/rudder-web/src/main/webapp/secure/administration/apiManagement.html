<lift:surround with="common-layout" at="content">

  <div data-lift="administration.ApiAccounts.render">
    That gives us a JS variable with the servlet
    context path named "contextPath" and the API
    path for token management named apiPath
    var contextPath = "/rudder"";
  </div>

  <head>
    <title>Rudder - API accounts</title>
    <link type="text/css" rel="stylesheet" data-lift="with-cached-resource"
      href="/style/rudder/datepicker.css" media="screen">
    <link type="text/css" rel="stylesheet" data-lift="with-cached-resource"
      href="/style/rudder/rudder-elm-datepicker.css" media="screen">
    <link type="text/css" rel="stylesheet" data-lift="with-cached-resource"
      href="/style/rudder/rudder-accounts.css" media="screen">
  </head>

  <div data-lift="administration.ApiAccounts.body">
    <div id="accounts-app"></div>
    <script>
      var app;
      $(document).ready(function () {
        var main = document.getElementById("accounts-app")
        var initValues = {
          contextPath: contextPath
          , hasWriteRights: hasWriteRights
        };

        app = Elm.Accounts.init({node: main, flags: initValues});

        app.ports.successNotification.subscribe(function (str) {
          createSuccessNotification(str)
        });

        app.ports.errorNotification.subscribe(function (str) {
          createErrorNotification(str)
        });

        app.ports.copy.subscribe(function (str) {
          navigator.clipboard.writeText(str);
        });
        // Initialize tooltips
        app.ports.initTooltips.subscribe(function (msg) {
          setTimeout(function () {
            initBsTooltips();
          }, 600);
        });
      });
    </script>
    <div id="acl-app"></div>
    <div id="tenants-app"></div>
  </div>

  <script data-lift="with-cached-resource" src="/javascript/rudder/elm/rudder-accounts.js"></script>

  <script>
    var hasWriteRights = false;
  </script>
  <lift:authz role="administration_write">
    <script>
      var hasWriteRights = true;
    </script>
  </lift:authz>
</lift:surround>
